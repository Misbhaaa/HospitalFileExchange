<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Sign Up Page</title>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f5f6f8; /* Light pastel gray */
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #4a4a4a;
        }
        .signup-container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 1000px;
            text-align: left;
            position: relative;
        }
        h2 {
            color: #6b7280; /* Pastel gray */
            font-size: 1.8rem;
            margin-bottom: 25px;
            text-align: center;
        }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        .form-group {
            position: relative;
            margin-bottom: 20px;
        }
        label {
            position: absolute;
            left: 12px;
            top: 12px;
            color: #9ca3af; /* Light gray */
            font-size: 0.9rem;
            pointer-events: none;
            transition: all 0.2s ease;
        }
        input, select, textarea {
            width: 100%;
            padding: 16px 12px 8px;
            border: 1px solid #e5e7eb; /* Light gray border */
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 0.9rem;
            background: #f9fafb; /* Very light gray */
            height: 50px;
        }
        textarea {
            height: 80px;
            resize: vertical;
        }
        input:focus, select:focus, textarea:focus {
            border-color: #60a5fa; /* Pastel blue */
            outline: none;
        }
        input:focus + label,
        input:not(:placeholder-shown) + label,
        select:focus + label,
        select:not(:placeholder-shown) + label,
        textarea:focus + label,
        textarea:not(:placeholder-shown) + label {
            top: 4px;
            font-size: 0.75rem;
            color: #60a5fa;
        }
        .eye-icon, .calendar-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            cursor: pointer;
            color: #9ca3af;
            background: none;
            border: none;
            padding: 0;
        }
        .date-picker {
            position: absolute;
            top: 55px;
            left: 0;
            background: #fff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 10px;
            display: none;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .date-picker.active {
            display: flex;
            gap: 5px;
        }
        .date-picker select {
            width: 70px;
            height: 30px;
            font-size: 0.9rem;
        }
        .date-picker button {
            width: auto;
            padding: 5px 10px;
            font-size: 0.8rem;
        }
        button {
            width: 100%;
            padding: 12px;
            background-color: #bfdbfe; /* Pastel blue */
            color: #1e40af;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            grid-column: 1 / -1;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #93c5fd;
        }
        .error-message {
            display: none;
            color: #f87171; /* Pastel red */
            font-size: 0.75rem;
            margin-top: 5px;
            padding-left: 12px;
        }
        .error-message.active {
            display: block;
        }
        .success-message {
            display: none;
            color: #6ee7b7; /* Pastel green */
            font-size: 0.75rem;
            margin-top: 5px;
            padding-left: 12px;
        }
        .success-message.active {
            display: block;
        }
        input.error, select.error, textarea.error {
            border-color: #f87171;
        }
        input.success {
            border-color: #6ee7b7;
        }
        .form-success {
            display: none;
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #6ee7b7;
            color: #fff;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.9rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            z-index: 10;
            animation: fadeOut 3s forwards;
        }
        .form-success.active {
            display: block;
        }
        @keyframes fadeOut {
            0% { opacity: 1; }
            80% { opacity: 1; }
            100% { opacity: 0; display: none; }
        }
    </style>
</head>
<body>
    <div class="signup-container">
        <div class="form-success" id="form-success">Sign-up submitted successfully!</div>
        <form id="signup-form">
            <h2>Doctor Details</h2>
            <div class="form-grid">
                <div class="form-group">
                    <input type="text" id="first-name" name="first-name" placeholder=" " required class="required">
                    <label for="first-name">First Name</label>
                    <span class="error-message" id="first-name-error">This field is required</span>
                </div>
                <div class="form-group">
                    <input type="text" id="last-name" name="last-name" placeholder=" " required class="required">
                    <label for="last-name">Last Name</label>
                    <span class="error-message" id="last-name-error">This field is required</span>
                </div>
                <div class="form-group">
                    <input type="email" id="email" name="email" placeholder=" " required class="required">
                    <label for="email">Email</label>
                    <span class="error-message" id="email-error"></span>
                </div>
                <div class="form-group">
                    <input type="tel" id="mobile" name="mobile" placeholder=" " required class="required">
                    <label for="mobile">Mobile</label>
                    <span class="error-message" id="mobile-error">Enter a 10-digit mobile number</span>
                </div>
                <div class="form-group">
                    <input type="password" id="password" name="password" placeholder=" " required class="required">
                    <label for="password">Password</label>
                    <button type="button" class="eye-icon" onclick="togglePassword('password')">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                    </button>
                    <span class="error-message" id="password-error">This field is required</span>
                </div>
                <div class="form-group">
                    <input type="password" id="confirm-password" name="confirm-password" placeholder=" " required class="required">
                    <label for="confirm-password">Confirm Password</label>
                    <button type="button" class="eye-icon" onclick="togglePassword('confirm-password')">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                    </button>
                    <span class="error-message" id="confirm-password-error"></span>
                    <span class="success-message" id="confirm-password-success">Passwords match</span>
                </div>
                <div class="form-group">
                    <input type="text" id="date-of-birth" name="date-of-birth" placeholder=" " required class="required" readonly>
                    <label for="date-of-birth">Date of Birth (DD/MM/YYYY)</label> <!-- Changed: Updated label -->
                    <button type="button" class="calendar-icon" onclick="toggleDatePicker()">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zm0-12H5V6h14v2z"/>
                        </svg>
                    </button>
                    <div class="date-picker" id="dob-picker">
                        <select id="dob-day"></select>
                        <select id="dob-month">
                            <option value="01">01</option><option value="02">02</option><option value="03">03</option>
                            <option value="04">04</option><option value="05">05</option><option value="06">06</option>
                            <option value="07">07</option><option value="08">08</option><option value="09">09</option>
                            <option value="10">10</option><option value="11">11</option><option value="12">12</option>
                        </select>
                        <select id="dob-year"></select>
                        <button type="button" onclick="setDate()">OK</button>
                    </div>
                    <span class="error-message" id="date-of-birth-error">This field is required</span>
                </div>
                <div class="form-group">
                    <select id="gender" name="gender" required class="required">
                        <option value="" selected disabled></option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                    <label for="gender">Gender</label>
                    <span class="error-message" id="gender-error">This field is required</span>
                </div>
                <div class="form-group">
                    <select id="department" name="department" required class="required">
                        <option value="" selected disabled></option>
                        <option value="General Practice">General Practice</option>
                        <option value="Cardiology">Cardiology</option>
                        <option value="Pediatrics">Pediatrics</option>
                        <option value="Neurology">Neurology</option>
                        <option value="Other">Other</option>
                    </select>
                    <label for="department">Department</label>
                    <span class="error-message" id="department-error">This field is required</span>
                </div>
                <div class="form-group">
                    <input type="text" id="designation" name="designation" placeholder=" " required class="required">
                    <label for="designation">Designation</label>
                    <span class="error-message" id="designation-error">This field is required</span>
                </div>
                <div class="form-group">
                    <input type="text" id="container-name" name="container-name" placeholder=" " required class="required">
                    <label for="container-name">Container Name</label>
                    <span class="error-message" id="container-name-error">This field is required</span>
                </div>
                <div class="form-group">
                    <textarea id="address" name="address" placeholder=" " required class="required"></textarea>
                    <label for="address">Address</label>
                    <span class="error-message" id="address-error">This field is required</span>
                </div>
                <div class="form-group">
                    <select id="country" name="country" required class="required">
                        <option value="" selected disabled></option>
                        <option value="Afghanistan">Afghanistan (+93)</option>
                        <option value="Albania">Albania (+355)</option>
                        <option value="Algeria">Algeria (+213)</option>
                        <option value="Argentina">Argentina (+54)</option>
                        <option value="Australia">Australia (+61)</option>
                        <option value="Brazil">Brazil (+55)</option>
                        <option value="Canada">Canada (+1)</option>
                        <option value="China">China (+86)</option>
                        <option value="France">France (+33)</option>
                        <option value="Germany">Germany (+49)</option>
                        <option value="India">India (+91)</option>
                        <option value="Italy">Italy (+39)</option>
                        <option value="Japan">Japan (+81)</option>
                        <option value="Mexico">Mexico (+52)</option>
                        <option value="Russia">Russia (+7)</option>
                        <option value="South Africa">South Africa (+27)</option>
                        <option value="United Kingdom">United Kingdom (+44)</option>
                        <option value="United States">United States (+1)</option>
                        <!-- Full list abbreviated; add more as needed -->
                    </select>
                    <label for="country">Country</label>
                    <span class="error-message" id="country-error">This field is required</span>
                </div>
                <button type="submit">Submit</button>
            </div>
        </form>
    </div>

    <script>
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const icon = input.nextElementSibling;
            if (input.type === "password") {
                input.type = "text";
                icon.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.54-1.36 2.76-3.11 3.55-5.25C21.27 7.61 17 4.5 12 4.5c-2.66 0-5.06.92-6.97 2.39L7.17 9c-.57-.23-1.18-.36-1.83-.36-2.76 0-5 2.24-5 5 0 .65.13 1.26.36 1.83l2.92 2.92c1.54-1.36 2.76-3.11 3.55-5.25l-2.14-2.14C6.94 8.92 9.34 7 12 7zm-1.27 4.73l4.54 4.54c.36-.57.73-1.18.73-1.83 0-2.76-2.24-5-5-5-.65 0-1.26.13-1.83.36zm2.54 5.54l-4.54-4.54c-.36.57-.73 1.18-.73 1.83 0 2.76 2.24 5 5 5 .65 0 1.26-.13 1.83-.36z"/>
                    </svg>`;
            } else {
                input.type = "password";
                icon.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                    </svg>`;
            }
        }

        function toggleDatePicker() {
            const picker = document.getElementById('dob-picker');
            const daySelect = document.getElementById('dob-day');
            const monthSelect = document.getElementById('dob-month');
            const yearSelect = document.getElementById('dob-year');
            const currentYear = new Date().getFullYear();

            picker.classList.toggle('active');

            if (picker.classList.contains('active') && daySelect.options.length === 0) {
                // Populate days (01-31)
                for (let i = 1; i <= 31; i++) {
                    const day = i < 10 ? `0${i}` : i;
                    daySelect.innerHTML += `<option value="${day}">${day}</option>`;
                }
                // Populate years (last 100 years, four digits)
                for (let i = currentYear - 100; i <= currentYear; i++) {
                    yearSelect.innerHTML += `<option value="${i}">${i}</option>`;
                }
                // Set defaults
                if (!monthSelect.value) monthSelect.value = '01';
                if (!yearSelect.value) yearSelect.value = currentYear;
                updateDays();
            }
        }

        function updateDays() {
            const month = document.getElementById('dob-month').value;
            const year = document.getElementById('dob-year').value;
            const daySelect = document.getElementById('dob-day');
            if (!month || !year) return;

            const daysInMonth = new Date(parseInt(year), parseInt(month), 0).getDate();
            const selectedDay = daySelect.value;
            daySelect.innerHTML = '';

            for (let i = 1; i <= daysInMonth; i++) {
                const day = i < 10 ? `0${i}` : i;
                daySelect.innerHTML += `<option value="${day}">${day}</option>`;
            }
            daySelect.value = selectedDay && parseInt(selectedDay) <= daysInMonth ? selectedDay : '01';
        }

        function setDate() {
            const day = document.getElementById('dob-day').value;
            const month = document.getElementById('dob-month').value;
            const year = document.getElementById('dob-year').value;
            const dobInput = document.getElementById('date-of-birth');
            if (day && month && year) {
                dobInput.value = `${day}/${month}/${year}`; // Changed: Now uses full year (YYYY)
                document.getElementById('dob-picker').classList.remove('active');
            }
        }

        document.addEventListener('click', function(event) {
            const picker = document.getElementById('dob-picker');
            const calendarIcon = event.target.closest('.calendar-icon');
            if (!picker.contains(event.target) && !calendarIcon) {
                picker.classList.remove('active');
            }
        });

        document.getElementById('dob-month').addEventListener('change', updateDays);
        document.getElementById('dob-year').addEventListener('change', updateDays);

        const registeredUsers = [
            { email: "test@example.com", mobile: "1234567890" },
            { email: "doctor@hospital.com", mobile: "0987654321" }
        ];

        const emailInput = document.getElementById('email');
        const emailError = document.getElementById('email-error');
        const mobileInput = document.getElementById('mobile');
        const mobileError = document.getElementById('mobile-error');
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

        emailInput.addEventListener('input', function() {
            const email = emailInput.value.trim();
            emailError.classList.remove('active');
            emailInput.classList.remove('error');

            if (email && !emailRegex.test(email)) {
                emailError.textContent = 'Please enter a valid email address';
                emailError.classList.add('active');
                emailInput.classList.add('error');
            } else if (email && registeredUsers.some(user => user.email === email)) {
                emailError.textContent = 'Email already registered. Do you want to sign in?';
                emailError.classList.add('active');
                emailInput.classList.add('error');
            }
        });

        mobileInput.addEventListener('input', function() {
            const mobile = mobileInput.value.trim();
            mobileError.classList.remove('active');
            mobileInput.classList.remove('error');
            mobileInput.classList.remove('success');

            if (mobile) {
                if (!/^\d{10}$/.test(mobile)) {
                    mobileError.textContent = 'Enter a 10-digit mobile number';
                    mobileError.classList.add('active');
                    mobileInput.classList.add('error');
                } else if (registeredUsers.some(user => user.mobile === mobile)) {
                    mobileError.textContent = 'Mobile number already registered';
                    mobileError.classList.add('active');
                    mobileInput.classList.add('error');
                } else {
                    mobileError.classList.remove('active');
                    mobileInput.classList.add('success');
                }
            }
        });

        const passwordInput = document.getElementById('password');
        const confirmPasswordInput = document.getElementById('confirm-password');
        const confirmPasswordError = document.getElementById('confirm-password-error');
        const confirmPasswordSuccess = document.getElementById('confirm-password-success');

        confirmPasswordInput.addEventListener('input', function() {
            const password = passwordInput.value.trim();
            const confirmPassword = confirmPasswordInput.value.trim();

            confirmPasswordError.classList.remove('active');
            confirmPasswordSuccess.classList.remove('active');
            confirmPasswordInput.classList.remove('error', 'success');

            if (confirmPassword) {
                if (password !== confirmPassword) {
                    confirmPasswordError.textContent = 'Passwords do not match';
                    confirmPasswordError.classList.add('active');
                    confirmPasswordInput.classList.add('error');
                } else {
                    confirmPasswordSuccess.textContent = 'Passwords match';
                    confirmPasswordSuccess.classList.add('active');
                    confirmPasswordInput.classList.add('success');
                }
            }
        });

        passwordInput.addEventListener('input', function() {
            const password = passwordInput.value.trim();
            const confirmPassword = confirmPasswordInput.value.trim();

            if (confirmPassword) {
                confirmPasswordError.classList.remove('active');
                confirmPasswordSuccess.classList.remove('active');
                confirmPasswordInput.classList.remove('error', 'success');

                if (password !== confirmPassword) {
                    confirmPasswordError.textContent = 'Passwords do not match';
                    confirmPasswordError.classList.add('active');
                    confirmPasswordInput.classList.add('error');
                } else {
                    confirmPasswordSuccess.textContent = 'Passwords match';
                    confirmPasswordSuccess.classList.add('active');
                    confirmPasswordInput.classList.add('success');
                }
            }
        });

        document.getElementById('signup-form').addEventListener('submit', function(event) {
            event.preventDefault();
            let isValid = true;

            document.querySelectorAll('.error-message').forEach(error => error.classList.remove('active'));
            document.querySelectorAll('input, select, textarea').forEach(field => field.classList.remove('error'));

            const requiredFields = [
                { id: 'first-name', errorId: 'first-name-error' },
                { id: 'last-name', errorId: 'last-name-error' },
                { id: 'email', errorId: 'email-error' },
                { id: 'mobile', errorId: 'mobile-error' },
                { id: 'password', errorId: 'password-error' },
                { id: 'confirm-password', errorId: 'confirm-password-error' },
                { id: 'date-of-birth', errorId: 'date-of-birth-error' },
                { id: 'gender', errorId: 'gender-error' },
                { id: 'department', errorId: 'department-error' },
                { id: 'designation', errorId: 'designation-error' },
                { id: 'container-name', errorId: 'container-name-error' },
                { id: 'address', errorId: 'address-error' },
                { id: 'country', errorId: 'country-error' }
            ];

            requiredFields.forEach(field => {
                const input = document.getElementById(field.id);
                const error = document.getElementById(field.errorId);
                if (!input.value.trim()) {
                    error.textContent = 'This field is required';
                    error.classList.add('active');
                    input.classList.add('error');
                    isValid = false;
                }
            });

            const email = emailInput.value.trim();
            const mobile = mobileInput.value.trim();
            const password = passwordInput.value.trim();
            const confirmPassword = confirmPasswordInput.value.trim();

            if (!emailRegex.test(email)) {
                emailError.textContent = 'Please enter a valid email address';
                emailError.classList.add('active');
                emailInput.classList.add('error');
                isValid = false;
            }

            if (!/^\d{10}$/.test(mobile)) {
                mobileError.textContent = 'Enter a 10-digit mobile number';
                mobileError.classList.add('active');
                mobileInput.classList.add('error');
                isValid = false;
            }

            if (password !== confirmPassword) {
                confirmPasswordError.textContent = 'Passwords do not match';
                confirmPasswordError.classList.add('active');
                confirmPasswordInput.classList.add('error');
                isValid = false;
            }

            if (isValid) {
                const formData = {
                    'first-name': document.getElementById('first-name').value,
                    'last-name': document.getElementById('last-name').value,
                    'email': email,
                    'mobile': mobile,
                    'password': password,
                    'date-of-birth': document.getElementById('date-of-birth').value,
                    'gender': document.getElementById('gender').value,
                    'department': document.getElementById('department').value,
                    'designation': document.getElementById('designation').value,
                    'container-name': document.getElementById('container-name').value,
                    'address': document.getElementById('address').value,
                    'country': document.getElementById('country').value
                };

                fetch('/signup/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCookie('csrftoken')
                    },
                    body: JSON.stringify(formData)
                })
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        alert('Error: ' + data.error);
                    } else {
                        const successMessage = document.getElementById('form-success');
                        successMessage.textContent = 'Signup successful! Redirecting...';
                        successMessage.classList.add('active');
                        setTimeout(() => {
                            window.location.href = '/';
                        }, 2000);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('An error occurred. Please try again.');
                });
            }
        });

        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
    </script>
</body>
</html>